<!DOCTYPE html>
<html>
<head>
<title>新增图书信息</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<script src="../../scripts/boot.js" type="text/javascript"></script>
<link href="../../demo/demo.css" rel="stylesheet" type="text/css" />

<style type="text/css">
html, body {
	padding: 0;
	margin: 0;
	border: 0;
	height: 100%;
	overflow: hidden;
}
</style>
</head>
<body>

	<form id="form1" method="post">
		<fieldset style="border: solid 1px #aaa; padding: 3px;">
			<legend>新增图书信息</legend>
			<div style="padding: 5px;">
				<table>
					<tr>
						<td align="right">图书名称：</td>
						<td><input name="bookName" class="mini-textbox"
							emptyText="请输入图书名称" required="true" requiredErrorText="你忘记写图书名称了" />
						</td>

						<td align="right">出版社：</td>
						<td><input name="publisher" class="mini-textbox"
							required="true" emptyText="请输入出版社" /></td>
					</tr>
					<tr>
						<td align="right">作者：</td>
						<td><input name="author" class="mini-textbox" required="true"
							emptyText="请输入作者" /></td>

						<td align="right">图书类别：</td>
						<td><input name="bookType" class="mini-combobox"
							url="../../data/booktype.txt" showNullItem="true"
							nullItemText="-请选择类别-" allowInput="true" /></td>
					</tr>
					<tr>
						<td align="right">剩余数量：</td>
						<td><input name="remain" class="mini-spinner" minValue="1"
							maxValue="200" increment=1 format="#,0" /></td>
					</tr>
				</table>
			</div>
		</fieldset>
		<div style="text-align: center; padding: 10px;">
			<a class="mini-button" onclick="onOk()"
				style="width: 60px; margin-right: 20px;">确定</a> <a
				class="mini-button" onclick="onCancel()" style="width: 60px;">取消</a>
		</div>
	</form>
	<script type="text/javascript">
        mini.parse();


        var form = new mini.Form("form1");

        //保存数据
        function SaveData() {
            var o = form.getData();            

            form.validate();
            if (form.isValid() == false) {
            	return;
            }

            var json = mini.encode(o);
            $.ajax({
                url: "../../bookinfoaddaction?method=addbookinfo",
		        type: 'post',
                data: { data: json },
                cache: false,
                success: function (text) {
                    mini.alert(text, "提示：", function(){
                        CloseWindow("save");
                    })	
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(jqXHR.responseText);
                    CloseWindow();
                }
            });
        }

        
        //关闭窗口
        function CloseWindow(action) {            
            if (window.CloseOwnerWindow){
            	return window.CloseOwnerWindow(action);
            }
            else{
            	return window.close();            
            }
        }
        
        //确认
        function onOk(e) {
            SaveData();
        }
        
        //取消
        function onCancel(e) {
            CloseWindow("cancel");
        }

    </script>
</body>
</html>